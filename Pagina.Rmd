---
---
---

```{r}

#install.packages("readxl")

library(readxl)
library(dplyr)
library(ggplot2)
library(ggmosaic)
```

```{r}
Ruta_archivo <- "est_pol_2024.xls"

datos <- read_excel(Ruta_archivo)

```

```{r}
#1 variable
dfTest <- head(datos, n=)
dfDelitos <- datos %>% ggplot(aes(x=Delito, y=1)) +
  geom_bar(stat = "identity", aes(fill="")) +
  theme(legend.position = "none") +
  labs(y="Numero de delitos")
dfDelitos
```

```{r}
#1 variable
dfGenero <- datos %>% ggplot() +
  geom_mosaic(aes(x=product(Genero), fill=Genero),
             offset = 0) +
  geom_mosaic_text(aes(x = product(Genero), fill = Genero), offset = 0)+
  theme(legend.position = "top")
dfGenero
```

```{r}
#1 variable
dfVictima <- datos %>%
  ggplot(aes(x = Victima)) +
  geom_bar() +
  labs(title = "Distribution of Victims", x = "Victima", y = "Cantidad") +
  theme_minimal() 
dfVictima

```


```{r}
#1 variable
data_summary <- datos %>%
  group_by(Fecha) %>%
  summarise(count = n())

line_graph <- ggplot(data_summary, aes(x = Fecha, y = count)) +
  geom_line() +
  labs(title = "Cantidad de delitos con el tiempo", x = "Fecha", y = "Cantidad") +
  theme_minimal() +
  scale_x_date(date_breaks = "10 days", date_labels = "%Y-%m-%d") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  

print(line_graph)
```

```{r}
# 2 variables
dfDelGen <-  ggplot(datos, aes(x = Delito, fill = Genero)) +
  geom_bar(position = "stack", color = "black") +
  labs(title = "Distribucion de Delito por Genero", x = "Delito", y = "Cantidad") +
  theme_minimal() +
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 45, hjust = 1))

print(dfDelGen)
```

```{r}
# 2 variables
dfDelHor <- datos %>% 
  ggplot(aes(x = Hora, group = Delito, color = Delito)) +
  geom_line(stat = "count") +
  labs(title = "Comparacion de Delito por Hora", x = "Hora del dia", y = "Cantidad") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom")

print(dfDelHor)
```

```{r}
# Facetas
dfVicEdad <- datos %>% 
  ggplot(aes(x = Victima, fill = Victima)) +
  geom_bar() +
  facet_wrap(~Edad) +  
  labs(title = "Comparacion de victima por edad", x = "Victima", y = "Cantidad") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

print(dfVicEdad)

```